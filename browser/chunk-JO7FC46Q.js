import{a as T,b as H}from"./chunk-QMYRDWCN.js";import{ea as z,fa as A,ia as N,ka as W,oa as B,pa as j,ta as L,ua as U}from"./chunk-VLMZZGMH.js";import{$a as t,$b as V,Ca as P,Ea as l,Ia as w,Lb as G,Ma as y,Qa as _,Rb as I,Sb as k,Wb as F,Za as d,_a as n,a as M,ab as h,c as q,db as v,eb as u,f as O,fa as g,fb as s,ga as p,jb as E,lb as r,mb as f,nb as S,pb as x,qb as b,rb as C,zb as D}from"./chunk-NODDN4TF.js";function J(i,o){i&1&&(n(0,"div",8),r(1," \u23F3 Cargando promociones... "),t())}function K(i,o){i&1&&(n(0,"div",9),r(1," \u{1F4ED} No hay promociones registradas a\xFAn. "),t())}function Q(i,o){if(i&1&&h(0,"img",16),i&2){let e=s().$implicit;d("src",e.imagen,P)}}function X(i,o){i&1&&(n(0,"span",17),r(1,"Sin imagen"),t())}function Y(i,o){if(i&1){let e=v();n(0,"tr")(1,"td"),r(2),t(),n(3,"td"),r(4),t(),n(5,"td")(6,"strong"),r(7),t()(),n(8,"td"),_(9,Q,1,1,"img",12)(10,X,2,0,"ng-template",null,0,D),t(),n(12,"td",13)(13,"button",14),u("click",function(){let a=g(e).$implicit,m=s(2);return p(m.abrirModal(a))}),r(14,"\u270F\uFE0F Editar"),t(),n(15,"button",15),u("click",function(){let a=g(e).$implicit,m=s(2);return p(m.eliminarPromocion(a))}),r(16,"\u{1F5D1}\uFE0F Eliminar"),t()()()}if(i&2){let e=o.$implicit,c=E(11);l(2),f(e.titulo),l(2),f(e.descripcion),l(3),S("",e.descuento,"%"),l(2),d("ngIf",e.imagen)("ngIfElse",c)}}function Z(i,o){if(i&1&&(n(0,"table",10)(1,"thead")(2,"tr")(3,"th"),r(4,"T\xEDtulo"),t(),n(5,"th"),r(6,"Descripci\xF3n"),t(),n(7,"th"),r(8,"Descuento"),t(),n(9,"th"),r(10,"Imagen"),t(),n(11,"th"),r(12,"Acciones"),t()()(),n(13,"tbody"),_(14,Y,17,5,"tr",11),t()()),i&2){let e=s();l(14),d("ngForOf",e.promociones)}}function $(i,o){if(i&1&&(n(0,"div",32),h(1,"img",33),t()),i&2){let e=s(2);l(),d("src",e.nuevaPromocion.imagen,P)}}function ee(i,o){if(i&1){let e=v();n(0,"div",18)(1,"div",19)(2,"h3"),r(3),t(),n(4,"label",20),r(5,"\u{1F3AF} T\xEDtulo:"),t(),n(6,"input",21),C("ngModelChange",function(a){g(e);let m=s();return b(m.nuevaPromocion.titulo,a)||(m.nuevaPromocion.titulo=a),p(a)}),t(),n(7,"label",22),r(8,"\u{1F4DD} Descripci\xF3n:"),t(),n(9,"textarea",23),C("ngModelChange",function(a){g(e);let m=s();return b(m.nuevaPromocion.descripcion,a)||(m.nuevaPromocion.descripcion=a),p(a)}),t(),n(10,"label",24),r(11,"\u{1F4B8} Descuento (%):"),t(),n(12,"input",25),C("ngModelChange",function(a){g(e);let m=s();return b(m.nuevaPromocion.descuento,a)||(m.nuevaPromocion.descuento=a),p(a)}),t(),n(13,"label",26),r(14,"\u{1F5BC}\uFE0F Imagen:"),t(),n(15,"input",27),u("change",function(a){g(e);let m=s();return p(m.cargarImagen(a))}),t(),_(16,$,2,1,"div",28),n(17,"div",29)(18,"button",30),u("click",function(){g(e);let a=s();return p(a.guardarPromocion())}),r(19,"\u{1F4BE} Guardar"),t(),n(20,"button",31),u("click",function(){g(e);let a=s();return p(a.cerrarModal())}),r(21,"\u274C Cancelar"),t()()()()}if(i&2){let e=s();l(3),f(e.editandoId?"\u270F\uFE0F Editar Promoci\xF3n":"\u{1F381} Nueva Promoci\xF3n"),l(3),x("ngModel",e.nuevaPromocion.titulo),l(3),x("ngModel",e.nuevaPromocion.descripcion),l(3),x("ngModel",e.nuevaPromocion.descuento),l(4),d("ngIf",e.nuevaPromocion.imagen)}}var R,te=q(()=>{V();U();G();H();V();U();R=class i{constructor(o){this.promoService=o}promociones=[];cargando=!1;modalActivo=!1;editandoId=null;nuevaPromocion=this.obtenerPromocionVacia();ngOnInit(){this.cargarPromociones()}cargarPromociones(){this.cargando=!0,this.promoService.obtenerPromociones().subscribe({next:o=>{this.promociones=o,this.cargando=!1},error:o=>{console.error("\u274C Error al cargar promociones:",o),this.cargando=!1}})}abrirModal(o){this.modalActivo=!0,o?(this.editandoId=o.id,this.nuevaPromocion=M({},o)):(this.editandoId=null,this.nuevaPromocion=this.obtenerPromocionVacia())}cerrarModal(){this.modalActivo=!1,this.editandoId=null}guardarPromocion(){return O(this,null,function*(){if(this.nuevaPromocion.titulo.trim()&&this.nuevaPromocion.descuento>=0)try{this.editandoId?(yield this.promoService.actualizarPromocion(this.editandoId,this.nuevaPromocion),alert("\u2705 Promoci\xF3n actualizada correctamente.")):(yield this.promoService.agregarPromocion(this.nuevaPromocion),alert("\u2705 Promoci\xF3n agregada correctamente.")),this.cerrarModal(),this.cargarPromociones()}catch(o){console.error("\u274C Error al guardar promoci\xF3n:",o)}else alert("\u26A0\uFE0F Completa todos los campos requeridos.")})}eliminarPromocion(o){confirm("\u274C \xBFSeguro que deseas eliminar esta promoci\xF3n?")&&this.promoService.eliminarPromocion(o.id).then(()=>{alert("\u2705 Promoci\xF3n eliminada."),this.cargarPromociones()})}cargarImagen(o){let e=o.target.files[0];if(e){let c=new FileReader;c.onload=()=>{this.nuevaPromocion.imagen=c.result},c.readAsDataURL(e)}}obtenerPromocionVacia(){return{titulo:"",descripcion:"",descuento:0,imagen:""}}static \u0275fac=function(e){return new(e||i)(w(T))};static \u0275cmp=y({type:i,selectors:[["app-ofertas"]],decls:10,vars:4,consts:[["sinImagen",""],[1,"ofertas-panel"],[1,"acciones-ofertas"],[1,"btn-crear",3,"click"],["class","loader",4,"ngIf"],["class","sin-datos",4,"ngIf"],["class","tabla-ofertas",4,"ngIf"],["class","modal-bg",4,"ngIf"],[1,"loader"],[1,"sin-datos"],[1,"tabla-ofertas"],[4,"ngFor","ngForOf"],["alt","Imagen Promo",3,"src",4,"ngIf","ngIfElse"],[1,"acciones"],[1,"btn-detalles",3,"click"],[1,"btn-eliminar",3,"click"],["alt","Imagen Promo",3,"src"],[1,"texto-sin-imagen"],[1,"modal-bg"],[1,"modal"],["for","titulo"],["id","titulo","type","text",3,"ngModelChange","ngModel"],["for","descripcion"],["id","descripcion",3,"ngModelChange","ngModel"],["for","descuento"],["id","descuento","type","number","min","0","max","100",3,"ngModelChange","ngModel"],["for","imagen"],["type","file","accept","image/*",3,"change"],["class","imagen-preview",4,"ngIf"],[1,"acciones-modal"],[1,"btn-guardar",3,"click"],[1,"btn-cancelar",3,"click"],[1,"imagen-preview"],["alt","Vista previa",3,"src"]],template:function(e,c){e&1&&(n(0,"section",1)(1,"h2"),r(2,"\u{1F381} Gesti\xF3n de Promociones"),t(),n(3,"div",2)(4,"button",3),u("click",function(){return c.abrirModal()}),r(5,"\u2795 Nueva Promoci\xF3n"),t()(),_(6,J,2,0,"div",4)(7,K,2,0,"div",5)(8,Z,15,1,"table",6)(9,ee,22,5,"div",7),t()),e&2&&(l(6),d("ngIf",c.cargando),l(),d("ngIf",!c.cargando&&c.promociones.length===0),l(),d("ngIf",!c.cargando&&c.promociones.length>0),l(),d("ngIf",c.modalActivo))},dependencies:[F,I,k,L,z,W,A,j,B,N],styles:[".ofertas-panel[_ngcontent-%COMP%]{padding:2rem;background-color:#fefefe;border-radius:12px;box-shadow:0 2px 8px #0000001a;font-family:Segoe UI,sans-serif}.ofertas-panel[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;color:#2f855a;font-size:2rem;margin-bottom:1.5rem}.acciones-ofertas[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-bottom:1rem}.btn-crear[_ngcontent-%COMP%]{background-color:#38a169;color:#fff;border:none;padding:.7rem 1.2rem;border-radius:6px;font-weight:700;cursor:pointer;transition:background-color .3s ease}.btn-crear[_ngcontent-%COMP%]:hover{background-color:#2f855a}.loader[_ngcontent-%COMP%]{text-align:center;color:#718096;font-style:italic;margin:2rem 0}.sin-datos[_ngcontent-%COMP%]{text-align:center;color:#a0aec0;font-size:1.1rem;margin:2rem 0}.tabla-ofertas[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:1rem}.tabla-ofertas[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#edf2f7;color:#4a5568;padding:.8rem;text-align:left}.tabla-ofertas[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:1px solid #e2e8f0;padding:.7rem;vertical-align:middle}.tabla-ofertas[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60px;height:60px;object-fit:cover;border-radius:6px}.texto-sin-imagen[_ngcontent-%COMP%]{color:#a0aec0;font-style:italic}.acciones[_ngcontent-%COMP%]{display:flex;gap:.5rem}.btn-detalles[_ngcontent-%COMP%], .btn-eliminar[_ngcontent-%COMP%]{border:none;padding:.5rem .9rem;border-radius:5px;color:#fff;cursor:pointer;font-weight:500;transition:background-color .3s ease}.btn-detalles[_ngcontent-%COMP%]{background-color:#3182ce}.btn-detalles[_ngcontent-%COMP%]:hover{background-color:#2b6cb0}.btn-eliminar[_ngcontent-%COMP%]{background-color:#e53e3e}.btn-eliminar[_ngcontent-%COMP%]:hover{background-color:#c53030}.modal-bg[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#0006;display:flex;align-items:center;justify-content:center;z-index:999}.modal[_ngcontent-%COMP%]{background-color:#fff;padding:2rem;border-radius:10px;width:90%;max-width:500px;box-shadow:0 4px 12px #0000004d}.modal[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:1rem;color:#2f855a;font-size:1.5rem}.modal[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-top:.8rem;font-weight:500}.modal[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:.6rem;margin-top:.3rem;border:1px solid #cbd5e0;border-radius:5px;outline:none}.modal[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{resize:vertical}.imagen-preview[_ngcontent-%COMP%]{margin-top:.8rem;text-align:center}.imagen-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;border-radius:8px;box-shadow:0 1px 5px #0003}.acciones-modal[_ngcontent-%COMP%]{margin-top:1.2rem;display:flex;justify-content:flex-end;gap:.5rem}.btn-guardar[_ngcontent-%COMP%]{background-color:#38a169;color:#fff;border:none;padding:.5rem 1rem;border-radius:5px;font-weight:700;cursor:pointer}.btn-guardar[_ngcontent-%COMP%]:hover{background-color:#2f855a}.btn-cancelar[_ngcontent-%COMP%]{background-color:#718096;color:#fff;border:none;padding:.5rem 1rem;border-radius:5px;font-weight:700;cursor:pointer}.btn-cancelar[_ngcontent-%COMP%]:hover{background-color:#4a5568}@media (max-width: 768px){.tabla-ofertas[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .tabla-ofertas[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.9rem}.modal[_ngcontent-%COMP%]{width:95%}}"]})}});te();export{R as OfertasComponent};
