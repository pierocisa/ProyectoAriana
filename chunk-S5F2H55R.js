import{a as A,b as H}from"./chunk-E65ZWXOK.js";import{fa as L,ia as B,la as j,ma as U,na as W,ta as $,ua as q}from"./chunk-FCTPKBGF.js";import{$a as i,$b as z,Ab as y,Ea as a,Ia as h,Ma as M,Mb as R,Qa as _,Sb as F,Tb as V,Vb as N,Xb as T,_a as f,a as C,ab as t,c as Y,cb as S,db as O,eb as x,fa as m,fb as u,ga as p,gb as c,kb as w,mb as n,nb as g,ob as b,pb as E,qb as I,rb as D,sb as k,vb as P,wb as v}from"./chunk-C5GBN45Q.js";function J(d,o){if(d&1){let e=x();i(0,"button",7),u("click",function(){m(e);let l=c().$implicit,s=c();return p(s.validarPedido(l.id))}),n(1," \u2705 Validar "),t()}}function K(d,o){if(d&1){let e=x();i(0,"tr")(1,"td"),n(2),t(),i(3,"td"),n(4),t(),i(5,"td"),n(6),t(),i(7,"td"),n(8),t(),i(9,"td"),n(10),t(),i(11,"td"),n(12),P(13,"uppercase"),t(),i(14,"td")(15,"button",5),u("click",function(){let l=m(e).$implicit,s=c();return p(s.verDetalles(l))}),n(16,"\u{1F441}\uFE0F Ver"),t(),i(17,"button",5),u("click",function(){let l=m(e).$implicit,s=c();return p(s.abrirModal(l))}),n(18,"\u270F\uFE0F Editar"),t(),i(19,"button",5),u("click",function(){let l=m(e).$implicit,s=c();return p(s.eliminarPedido(l.id))}),n(20,"\u{1F5D1}\uFE0F"),t(),_(21,J,2,0,"button",6),t()()}if(d&2){let e=o.$implicit;a(2),g(e.id),a(2),E("",e.cliente.nombre," ",e.cliente.apellido),a(2),g(e.telefono),a(2),g(e.direccion),a(2),g(e.codigoPago),a(2),g(v(13,8,e.estado)),a(9),f("ngIf",e.estado==="PENDIENTE")}}function Q(d,o){if(d&1&&(S(0),i(1,"p",17),n(2),P(3,"uppercase"),t(),O()),d&2){let e=c(2);a(2),g(v(3,1,e.pedidoEditando.estado))}}function X(d,o){if(d&1){let e=x();i(0,"select",18),k("ngModelChange",function(l){m(e);let s=c(2);return D(s.pedidoEditando.estado,l)||(s.pedidoEditando.estado=l),p(l)}),i(1,"option",19),n(2,"\u23F3 Pendiente"),t(),i(3,"option",20),n(4,"\u2705 Enviado"),t(),i(5,"option",21),n(6,"\u274C Cancelado"),t()()}if(d&2){let e=c(2);I("ngModel",e.pedidoEditando.estado)}}function Z(d,o){if(d&1){let e=x();i(0,"button",22),u("click",function(){m(e);let l=c(2);return p(l.guardarCambiosPedido())}),n(1,"\u{1F4BE} Guardar Cambios"),t()}}function ee(d,o){if(d&1){let e=x();i(0,"div",8)(1,"div",9)(2,"h2"),n(3),t(),i(4,"div",10)(5,"p")(6,"strong"),n(7,"Cliente:"),t(),n(8),t(),i(9,"p")(10,"strong"),n(11,"Tel\xE9fono:"),t(),n(12),t(),i(13,"p")(14,"strong"),n(15,"Direcci\xF3n:"),t(),n(16),t(),i(17,"p")(18,"strong"),n(19,"C\xF3digo de Pago:"),t(),n(20),t()(),i(21,"div",11)(22,"label",12),n(23,"\u{1F6E0}\uFE0F Estado del Pedido"),t(),_(24,Q,4,3,"ng-container",13)(25,X,7,1,"ng-template",null,0,y),t(),i(27,"div",14),_(28,Z,2,0,"button",15),i(29,"button",16),u("click",function(){m(e);let l=c();return p(l.cerrarModal())}),n(30,"Cerrar"),t()()()()}if(d&2){let e=w(26),r=c();a(3),g(r.modoLectura?"\u{1F441}\uFE0F Detalles del Pedido":"\u270F\uFE0F Editar Estado del Pedido"),a(5),E(" ",r.pedidoEditando.cliente.nombre," ",r.pedidoEditando.cliente.apellido),a(4),b(" ",r.pedidoEditando.telefono),a(4),b(" ",r.pedidoEditando.direccion),a(4),b(" ",r.pedidoEditando.codigoPago),a(4),f("ngIf",r.modoLectura)("ngIfElse",e),a(4),f("ngIf",!r.modoLectura)}}var G,te=Y(()=>{z();q();R();H();z();q();G=class d{constructor(o){this.pedidoService=o}pedidos=[];modalActivo=!1;modoLectura=!1;pedidoEditando=null;ngOnInit(){this.obtenerPedidos()}obtenerPedidos(){this.pedidoService.obtenerPedidos().subscribe(o=>{this.pedidos=o.map(e=>({id:e.id,cliente:e.cliente||{nombre:"Sin nombre",apellido:""},telefono:e.cliente?.telefono||"No registrado",direccion:e.cliente?.direccion||"No registrada",codigoPago:e.cliente?.codigoPago||e.codigoPago||"No ingresado",estado:e.estado?.toUpperCase()||"PENDIENTE"}))})}verDetalles(o){this.modoLectura=!0,this.pedidoEditando=C({},o),this.modalActivo=!0}abrirModal(o){this.modoLectura=!1,this.pedidoEditando=C({},o),this.modalActivo=!0}cerrarModal(){this.modalActivo=!1,this.pedidoEditando=null,this.modoLectura=!1}eliminarPedido(o){confirm("\u{1F5D1}\uFE0F \xBFEst\xE1s seguro de que deseas eliminar este pedido? Esta acci\xF3n no se puede deshacer.")&&this.pedidoService.eliminarPedido(o).then(()=>{alert("\u2705 Pedido eliminado correctamente."),this.obtenerPedidos()}).catch(e=>{console.error("\u274C Error al eliminar el pedido:",e),alert("\u26A0\uFE0F No se pudo eliminar el pedido. Intenta nuevamente.")})}guardarCambiosPedido(){this.pedidoEditando?.id&&this.pedidoService.actualizarPedido(this.pedidoEditando.id,{estado:this.pedidoEditando.estado}).then(()=>{alert("\u2705 Estado actualizado correctamente"),this.cerrarModal(),this.obtenerPedidos()}).catch(o=>{console.error("\u274C Error al actualizar:",o),alert("\u26A0\uFE0F No se pudo actualizar el estado del pedido")})}validarPedido(o){confirm("\u2705 \xBFConfirmas que el pago ha sido validado y el pedido ser\xE1 marcado como ENVIADO?")&&this.pedidoService.actualizarPedido(o,{estado:"ENVIADO"}).then(()=>{alert("\u{1F69A} Pedido validado y marcado como ENVIADO."),this.obtenerPedidos()}).catch(e=>{console.error("\u274C Error al validar pedido:",e),alert("\u26A0\uFE0F No se pudo validar el pedido")})}static \u0275fac=function(e){return new(e||d)(h(A))};static \u0275cmp=M({type:d,selectors:[["app-pedidos"]],decls:23,vars:2,consts:[["editarEstado",""],[1,"admin-container"],[1,"admin-table"],[4,"ngFor","ngForOf"],["class","modal-bg",4,"ngIf"],[3,"click"],["class","btn-validar",3,"click",4,"ngIf"],[1,"btn-validar",3,"click"],[1,"modal-bg"],[1,"modal"],[1,"info-cliente"],[1,"campo-form"],["for","estado"],[4,"ngIf","ngIfElse"],[1,"acciones-modal"],["class","btn-guardar",3,"click",4,"ngIf"],[1,"btn-cancelar",3,"click"],[2,"margin-top","0.5rem","font-weight","bold"],["id","estado",3,"ngModelChange","ngModel"],["value","pendiente"],["value","enviado"],["value","cancelado"],[1,"btn-guardar",3,"click"]],template:function(e,r){e&1&&(i(0,"div",1)(1,"h2"),n(2,"\u{1F4E6} Gesti\xF3n de Pedidos"),t(),i(3,"table",2)(4,"thead")(5,"tr")(6,"th"),n(7,"ID"),t(),i(8,"th"),n(9,"Cliente"),t(),i(10,"th"),n(11,"Tel\xE9fono"),t(),i(12,"th"),n(13,"Direcci\xF3n"),t(),i(14,"th"),n(15,"Codigo Pago"),t(),i(16,"th"),n(17,"Estado"),t(),i(18,"th"),n(19,"Acciones"),t()()(),i(20,"tbody"),_(21,K,22,10,"tr",3),t()()(),_(22,ee,31,9,"div",4)),e&2&&(a(21),f("ngForOf",r.pedidos),a(),f("ngIf",r.modalActivo))},dependencies:[T,F,V,$,U,W,j,L,B,N],styles:[".admin-container[_ngcontent-%COMP%]{padding:2rem;background-color:#f9f9f9;border-radius:16px;box-shadow:0 4px 12px #00000014;font-family:Segoe UI,sans-serif}.admin-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.8rem;margin-bottom:1rem}.admin-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;background-color:#fff;border-radius:12px;overflow:hidden}.admin-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .admin-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem;text-align:left;border-bottom:1px solid #eee}.admin-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f0f0f0;font-weight:700}.admin-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle}.admin-table[_ngcontent-%COMP%]   td.estado-pendiente[_ngcontent-%COMP%]{color:#999;font-weight:700}.admin-table[_ngcontent-%COMP%]   td.estado-enviado[_ngcontent-%COMP%]{color:#28a745;font-weight:700}.admin-table[_ngcontent-%COMP%]   td.estado-cancelado[_ngcontent-%COMP%]{color:#dc3545;font-weight:700}button[_ngcontent-%COMP%]{padding:.4rem .8rem;margin:0 .2rem;border:none;border-radius:6px;font-size:.9rem;cursor:pointer;transition:background-color .3s ease}button[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.modal-bg[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#0006;display:flex;justify-content:center;align-items:center;z-index:1000}.modal[_ngcontent-%COMP%]{background:#fff;padding:2rem;border-radius:16px;width:90%;max-width:450px;box-shadow:0 6px 18px #00000026;animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}.modal[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-top:0;margin-bottom:1.5rem;font-size:1.5rem;color:#333}.info-cliente[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.5rem 0;color:#555}.modal[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-top:1.2rem;margin-bottom:.5rem;font-weight:700;color:#333}.modal[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:.6rem;border-radius:8px;border:1px solid #ccc;background-color:#f9f9f9;font-size:1rem}.acciones-modal[_ngcontent-%COMP%]{margin-top:2rem;display:flex;justify-content:flex-end;gap:.8rem}.btn-guardar[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;padding:.6rem 1rem;border:none;border-radius:8px;font-weight:700;cursor:pointer}.btn-guardar[_ngcontent-%COMP%]:hover{background-color:#45a049}.btn-cancelar[_ngcontent-%COMP%]{background-color:#f44336;color:#fff;padding:.6rem 1rem;border:none;border-radius:8px;font-weight:700;cursor:pointer}.btn-cancelar[_ngcontent-%COMP%]:hover{background-color:#e53935}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-16px)}to{opacity:1;transform:translateY(0)}}"]})}});te();export{G as PedidosComponent};
