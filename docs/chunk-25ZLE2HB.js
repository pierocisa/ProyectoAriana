import{d as F,h as ie}from"./chunk-3ENEVE7J.js";import{F as N,J as T,M as I,O as R,P as D,S as W,Y as A,aa as j,ca as Z,ea as B,fa as q,ga as z,ha as U,ia as G,ja as Y,qa as H,ra as J,sa as K,ta as Q,ua as X}from"./chunk-FCTPKBGF.js";import{$a as n,$b as O,Ab as S,Ea as s,Ia as d,Ma as L,Mb as te,Qa as u,Ta as E,Tb as V,Xb as k,_a as p,ab as o,c as ee,eb as b,f as C,fa as m,fb as f,ga as c,gb as _,kb as w,mb as l,nb as P,ob as h,qb as v,rb as x,sb as y}from"./chunk-C5GBN45Q.js";function ne(i,r){i&1&&(n(0,"h2"),l(1,"Iniciar sesi\xF3n"),o())}function re(i,r){i&1&&(n(0,"h2"),l(1,"Crear cuenta"),o())}function oe(i,r){if(i&1&&(n(0,"p",12),l(1),o()),i&2){let e=_();s(),P(e.infoMsg)}}function ae(i,r){if(i&1){let e=b();n(0,"button",15),f("click",function(){m(e);let g=_(2);return c(g.resendVerification())}),l(1," Reenviar correo "),o()}}function se(i,r){if(i&1&&(n(0,"p",13),l(1),u(2,ae,2,0,"button",14),o()),i&2){let e=_();s(),h(" ",e.errorMsg," "),s(),p("ngIf",e.errorMsg.includes("verificado"))}}var $,le=ee(()=>{O();X();D();Z();te();D();Z();ie();O();X();$=class i{constructor(r,e,t,g){this.auth=r;this.fs=e;this.router=t;this.ngZone=g}email="";password="";isLogin=!0;errorMsg="";infoMsg="";toggleMode(){this.errorMsg="",this.infoMsg="",this.isLogin=!this.isLogin}submit(r){return C(this,null,function*(){if(this.errorMsg="",this.infoMsg="",r.invalid){this.errorMsg="Por favor completa todos los campos.";return}try{if(this.isLogin){let e=yield R(this.auth,this.email,this.password);if(!e.user.emailVerified){this.errorMsg="\u274C Tu correo no est\xE1 verificado. Revisa tu bandeja.";return}localStorage.setItem("token",e.user.uid),this.ngZone.run(()=>this.router.navigate(["/admin"]))}else{let e=yield T(this.auth,this.email,this.password);yield I(e.user,{url:window.location.origin+"/login"}),yield j(A(this.fs,"users",e.user.uid),{email:e.user.email,role:"customer",createdAt:Date.now()}),this.infoMsg="\u2705 Te enviamos un correo de verificaci\xF3n. \xC1brelo (rev\xEDsate spam) y luego vuelve a iniciar sesi\xF3n.",this.isLogin=!0}}catch(e){this.errorMsg=e.code?e.code.replace("auth/","").replace(/-/g," "):e.message||"Error inesperado"}})}resendVerification(){return C(this,null,function*(){this.errorMsg="",this.infoMsg="";let r=this.auth.currentUser;r&&!r.emailVerified?(yield I(r,{url:window.location.origin+"/login"}),this.infoMsg="\u2705 Reenviamos el correo de verificaci\xF3n."):this.errorMsg="\u26A0\uFE0F No hay usuario pendiente de verificaci\xF3n."})}static \u0275fac=function(e){return new(e||i)(d(N),d(W),d(F),d(E))};static \u0275cmp=L({type:i,selectors:[["app-login"]],decls:19,vars:8,consts:[["regTitle",""],["f","ngForm"],[1,"login-panel"],[4,"ngIf","ngIfElse"],[1,"registro-link"],["href","#",3,"click"],[3,"ngSubmit"],["type","email","name","email","placeholder","ejemplo@gmail.com","required","","email","",3,"ngModelChange","ngModel"],["type","password","name","password","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022","required","","minlength","6",3,"ngModelChange","ngModel"],["type","submit",1,"btn-ingresar"],["class","info-msg",4,"ngIf"],["class","error-msg",4,"ngIf"],[1,"info-msg"],[1,"error-msg"],["class","btn-reenviar",3,"click",4,"ngIf"],[1,"btn-reenviar",3,"click"]],template:function(e,t){if(e&1){let g=b();n(0,"section",2),u(1,ne,2,0,"h2",3)(2,re,2,0,"ng-template",null,0,S),n(4,"p",4)(5,"a",5),f("click",function(a){return m(g),t.toggleMode(),c(a.preventDefault())}),l(6),o()(),n(7,"form",6,1),f("ngSubmit",function(){m(g);let a=w(8);return c(t.submit(a))}),n(9,"label"),l(10,"Email"),o(),n(11,"input",7),y("ngModelChange",function(a){return m(g),x(t.email,a)||(t.email=a),c(a)}),o(),n(12,"label"),l(13,"Contrase\xF1a"),o(),n(14,"input",8),y("ngModelChange",function(a){return m(g),x(t.password,a)||(t.password=a),c(a)}),o(),n(15,"button",9),l(16),o()(),u(17,oe,2,1,"p",10)(18,se,3,2,"p",11),o()}if(e&2){let g=w(3);s(),p("ngIf",t.isLogin)("ngIfElse",g),s(5),h(" ",t.isLogin?"\xBFEres nuevo? Reg\xEDstrate":"\xBFYa tienes cuenta? Inicia sesi\xF3n"," "),s(5),v("ngModel",t.email),s(3),v("ngModel",t.password),s(2),h(" ",t.isLogin?"Iniciar sesi\xF3n":"Registrarme"," "),s(),p("ngIf",t.infoMsg),s(),p("ngIf",t.errorMsg)}},dependencies:[k,V,Q,Y,B,q,z,H,K,J,G,U],styles:[".login-panel[_ngcontent-%COMP%]{max-width:380px;margin:4rem auto;padding:2.5rem;background:#fff;border-radius:8px;box-shadow:0 4px 12px #00000014;font-family:Segoe UI,sans-serif;color:#333}.login-panel[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:.6rem;font-size:1.6rem}.registro-link[_ngcontent-%COMP%]{text-align:center;margin-bottom:1.5rem;font-size:.95rem}.registro-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#2e7d32;text-decoration:none;font-weight:500}form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-weight:500;margin:1rem 0 .3rem;color:#444}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:10px;font-size:1rem;border:1px solid #bbb;border-radius:6px;transition:border .2s}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#2e7d32;outline:none}.btn-ingresar[_ngcontent-%COMP%]{width:100%;margin-top:1.5rem;background:#2e7d32;color:#fff;font-weight:600;padding:12px;border:none;border-radius:6px;cursor:pointer;transition:background .3s,transform .2s}.btn-ingresar[_ngcontent-%COMP%]:hover{background:#1b5e20;transform:scale(1.02)}.info-msg[_ngcontent-%COMP%]{margin-top:1rem;color:#2e7d32;text-align:center}.error-msg[_ngcontent-%COMP%]{margin-top:1rem;color:#c62828;text-align:center}.btn-reenviar[_ngcontent-%COMP%]{background:none;border:none;color:#1565c0;text-decoration:underline;cursor:pointer;margin-left:.5rem}"]})}});le();export{$ as LoginComponent};
