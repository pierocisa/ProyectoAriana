import{S as j,U as B,V as U,W as M,X as W,Y as w,ba as $,ca as q,ea as G,fa as L,ia as R,ta as H,ua as J}from"./chunk-FCTPKBGF.js";import{$ as D,$a as n,$b as N,Ca as h,Ea as l,Ma as S,Mb as v,Qa as C,Sb as T,Tb as z,X as I,Xb as A,_a as p,a as y,aa as P,ab as i,bb as f,c as E,eb as _,f as O,fa as g,fb as u,ga as m,gb as s,mb as r,nb as b,qb as k,rb as F,sb as V}from"./chunk-C5GBN45Q.js";var x,K=E(()=>{"use strict";q();v();q();x=class a{constructor(t){this.firestore=t}coleccion="categorias";agregarCategoria(t){let e=M(this.firestore,this.coleccion);return U(e,t)}obtenerCategorias(){let t=M(this.firestore,this.coleccion);return B(t,{idField:"id"})}actualizarCategoria(t,e){let o=w(this.firestore,`${this.coleccion}/${t}`);return $(o,e)}eliminarCategoria(t){let e=w(this.firestore,`${this.coleccion}/${t}`);return W(e)}static \u0275fac=function(e){return new(e||a)(D(j))};static \u0275prov=I({token:a,factory:a.\u0275fac,providedIn:"root"})}});function Y(a,t){if(a&1){let e=_();n(0,"button",11),u("click",function(){g(e);let c=s().index,d=s();return m(d.inhabilitar(c))}),r(1,"\u{1F6AB}"),i()}}function Z(a,t){if(a&1){let e=_();n(0,"button",12),u("click",function(){g(e);let c=s().index,d=s();return m(d.activar(c))}),r(1,"\u2705"),i()}}function ee(a,t){if(a&1){let e=_();n(0,"tr")(1,"td"),r(2),i(),n(3,"td"),f(4,"img",7),i(),n(5,"td"),r(6),i(),n(7,"td")(8,"button",8),u("click",function(){let c=g(e).index,d=s();return m(d.abrirModal(c))}),r(9,"\u270F\uFE0F"),i(),C(10,Y,2,0,"button",9)(11,Z,2,0,"button",10),i()()}if(a&2){let e=t.$implicit;l(2),b(e.nombre),l(2),p("src",e.imagen,h),l(2),b(e.estado==="activa"?"\u2705 Activa":"\u{1F6AB} Inactiva"),l(4),p("ngIf",e.estado==="activa"),l(),p("ngIf",e.estado==="inactiva")}}function te(a,t){if(a&1&&(n(0,"div",21),f(1,"img",22),i()),a&2){let e=s(2);l(),p("src",e.nuevaCategoria.imagen,h)}}function ne(a,t){if(a&1){let e=_();n(0,"div",13)(1,"div",14)(2,"h3"),r(3),i(),n(4,"label"),r(5,"Nombre:"),i(),n(6,"input",15),V("ngModelChange",function(c){g(e);let d=s();return F(d.nuevaCategoria.nombre,c)||(d.nuevaCategoria.nombre=c),m(c)}),i(),n(7,"label"),r(8,"Imagen:"),i(),n(9,"input",16),u("change",function(c){g(e);let d=s();return m(d.cargarImagen(c))}),i(),C(10,te,2,1,"div",17),n(11,"div",18)(12,"button",19),u("click",function(){g(e);let c=s();return m(c.guardarCategoria())}),r(13,"\u{1F4BE} Guardar"),i(),n(14,"button",20),u("click",function(){g(e);let c=s();return m(c.cerrarModal())}),r(15,"\u274C Cancelar"),i()()()()}if(a&2){let e=s();l(3),b(e.editandoId!==null?"\u270F\uFE0F Editar Categor\xEDa":"\u2795 Nueva Categor\xEDa"),l(3),k("ngModel",e.nuevaCategoria.nombre),l(4),p("ngIf",e.nuevaCategoria.imagen)}}var Q,ie=E(()=>{v();N();J();K();v();N();J();Q=class a{modalActivo=!1;editandoId=null;nuevaCategoria={nombre:"",imagen:"",estado:"activa"};categorias=[];cargando=!1;categoriaService=P(x);ngOnInit(){this.cargarCategorias()}cargarCategorias(){this.cargando=!0,this.categoriaService.obtenerCategorias().subscribe({next:t=>{console.log("\u{1F4E6} Categor\xEDas obtenidas:",t),this.categorias=t,this.cargando=!1},error:t=>{console.error("\u274C Error al obtener categor\xEDas:",t),this.cargando=!1}})}abrirModal(t){this.modalActivo=!0,t?(this.editandoId=t.id,this.nuevaCategoria=y({},t)):(this.editandoId=null,this.nuevaCategoria={nombre:"",imagen:"",estado:"activa"})}cerrarModal(){this.modalActivo=!1,this.editandoId=null,this.nuevaCategoria={nombre:"",imagen:"",estado:"activa"}}guardarCategoria(){return O(this,null,function*(){if(this.nuevaCategoria.nombre.trim()&&this.nuevaCategoria.imagen)try{this.editandoId?(yield this.categoriaService.actualizarCategoria(this.editandoId,this.nuevaCategoria),console.log("\u2705 Categor\xEDa actualizada")):(yield this.categoriaService.agregarCategoria(this.nuevaCategoria),console.log("\u2705 Categor\xEDa agregada")),this.cerrarModal(),this.cargarCategorias()}catch(t){console.error("\u274C Error al guardar categor\xEDa:",t)}else alert("\u26A0\uFE0F Completa todos los campos.")})}cargarImagen(t){let e=t.target.files[0];if(e){let o=new FileReader;o.onload=()=>{this.nuevaCategoria.imagen=o.result},o.readAsDataURL(e)}}inhabilitar(t){this.categoriaService.actualizarCategoria(t.id,{estado:"inactiva"}).then(()=>this.cargarCategorias())}activar(t){this.categoriaService.actualizarCategoria(t.id,{estado:"activa"}).then(()=>this.cargarCategorias())}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=S({type:a,selectors:[["app-categoria"]],decls:21,vars:2,consts:[[1,"categorias-panel"],[1,"acciones-categorias"],["type","text","placeholder","\u{1F50D} Buscar categor\xEDa...",1,"campo-busqueda"],[1,"btn-crear",3,"click"],[1,"tabla-categorias"],[4,"ngFor","ngForOf"],["class","modal-bg",4,"ngIf"],["alt","Imagen categor\xEDa","width","60",3,"src"],[1,"btn-editar",3,"click"],["class","btn-inhabilitar",3,"click",4,"ngIf"],["class","btn-activar",3,"click",4,"ngIf"],[1,"btn-inhabilitar",3,"click"],[1,"btn-activar",3,"click"],[1,"modal-bg"],[1,"modal"],["type","text","placeholder","Ej. Macetas",3,"ngModelChange","ngModel"],["type","file","accept","image/*",3,"change"],["class","imagen-preview",4,"ngIf"],[1,"acciones-modal"],[1,"btn-guardar",3,"click"],[1,"btn-cancelar",3,"click"],[1,"imagen-preview"],["alt","Vista previa","width","100",3,"src"]],template:function(e,o){e&1&&(n(0,"section",0)(1,"h2"),r(2,"\u{1F3F7}\uFE0F Gesti\xF3n de Categor\xEDas"),i(),n(3,"div",1),f(4,"input",2),n(5,"button",3),u("click",function(){return o.abrirModal()}),r(6,"\u2795 Crear Categor\xEDa"),i()(),n(7,"table",4)(8,"thead")(9,"tr")(10,"th"),r(11,"Nombre"),i(),n(12,"th"),r(13,"Imagen"),i(),n(14,"th"),r(15,"Estado"),i(),n(16,"th"),r(17,"Acciones"),i()()(),n(18,"tbody"),C(19,ee,12,5,"tr",5),i()()(),C(20,ne,16,3,"div",6)),e&2&&(l(19),p("ngForOf",o.categorias),l(),p("ngIf",o.modalActivo))},dependencies:[A,T,z,H,G,L,R],styles:[".categorias-panel[_ngcontent-%COMP%]{padding:1rem}.categorias-panel[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.6rem;margin-bottom:1rem;color:#333}.acciones-categorias[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;gap:1rem}.campo-busqueda[_ngcontent-%COMP%]{flex:1;max-width:300px;padding:8px;border:1px solid #ccc;border-radius:4px}.btn-crear[_ngcontent-%COMP%]{background-color:#2e7d32;color:#fff;border:none;padding:8px 14px;border-radius:4px;cursor:pointer}.tabla-categorias[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;background-color:#fff}.tabla-categorias[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .tabla-categorias[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #ddd;padding:10px;text-align:left}.tabla-categorias[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f0f0f0;font-weight:600}.btn-editar[_ngcontent-%COMP%], .btn-inhabilitar[_ngcontent-%COMP%], .btn-activar[_ngcontent-%COMP%]{background:none;border:none;font-size:1rem;margin-right:6px;cursor:pointer}.modal-bg[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#0006;display:flex;justify-content:center;align-items:center;z-index:999}.modal[_ngcontent-%COMP%]{background:#fff;padding:2rem;border-radius:8px;width:400px;max-width:90%;box-shadow:0 4px 8px #0003}.modal[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;margin-bottom:1rem;font-size:1.3rem}.modal[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-top:1rem;font-weight:500}.modal[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;margin-top:.5rem;padding:8px;border:1px solid #ccc;border-radius:4px}.acciones-modal[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:1.5rem;gap:10px}.btn-guardar[_ngcontent-%COMP%]{background-color:#2e7d32;color:#fff;border:none;padding:8px 12px;border-radius:4px;cursor:pointer}.btn-cancelar[_ngcontent-%COMP%]{background-color:#ccc;border:none;padding:8px 12px;border-radius:4px;cursor:pointer}"]})}});ie();export{Q as CategoriasComponent};
